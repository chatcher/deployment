#!/usr/bin/env bash

set -e
# set -x

usage() {
	echo "List all Pull Requests for current repo." >&2
	echo >&2
	echo "usage:" >&2
	echo "  $(basename "${0}") [-b|--body]" >&2
	echo >&2
	echo "options:" >&2
	echo "  -b    Also show the Pull Request body." >&2
	echo >&2

	if [ -n "${1}" ]; then echo -e "${A_CS} error: ${1} ${N_CS}" >&2; fi

	exit 1
}

if [[ "${1}" =~ ^-?-h(elp)?$ ]]; then usage ''; fi
list="$(get-pull-request-list)"

while read -u 3 -r details; do
	printpr "${@}" "${details}"
	# showpr "${@}" "$(jq -r .number <<< "${details}")"
done 3<<< "${list}"
